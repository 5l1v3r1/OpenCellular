from nute import utils
from opentest.server.service.iointerface_service import COMServiceClient
import argparse
import os

@utils.capture_print
def main(serverport, com, eth, mode):
    with COMServiceClient(url=com, ip="127.0.0.1", port=serverport) as client:
        if mode == 'IP':
            addr = client.com_get_ip(eth)
        #    print ("IP address: "+ ipaddr)
        elif mode == 'MAC':
            addr = client.com_get_mac(eth)
        #    print ("MAC address: "+ macaddr)
    print(addr)



if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='This script will get the IP addr')
    parser.add_argument('serverport', type=int, help='Server port')
    parser.add_argument('com', type=str, help='com port, example: COM133 ')
    parser.add_argument('eth', type=str, help='which eth')
    parser.add_argument('mode', type=str, help='IP or MAC')
    try:
        args = parser.parse_args()

        main(args.serverport, args.com, args.eth, args.mode, capture_print=False)
    except SystemExit as e:
        os.system("pause")
        raise
