from opentest.uut.uut import UUT, UUTError, Format
import unittest
import os

FOLDER = os.path.dirname(__file__)
OPENTEST_FOLDER = os.path.dirname(os.path.dirname(os.path.dirname(FOLDER)))

class TestUUT(unittest.TestCase):

    def test_correct_match(self):
        mrp = 'PRD-854-101A1'
        sn = 'NTQ0130921'
        mac = 'A3-AA-AA-AA-AA-AA'
        u = UUT()
        u.set_format([Format.MRP, Format.SN, Format.MAC_ADDR])
        u.scan_parse('%s;%s;%s' % (mrp, sn, mac))

        self.assertEqual(mrp, u.MRP)
        self.assertEqual(sn, u.SN)
        self.assertEqual(mac, u.MAC_ADDR)

    def test_incorrect_length(self):
        mrp = 'PRD-854-101A1'
        sn = 'NTQ0130921'
        mac = 'A3-AA-AA-AA-AA-AA'
        u = UUT()
        with self.assertRaises(UUTError):
            u.set_format([Format.MRP, Format.SN])
            u.scan_parse('%s;%s;%s' % (mrp, sn, mac))

            self.assertEqual(mrp, u.MRP)
            self.assertEqual(sn, u.SN)
