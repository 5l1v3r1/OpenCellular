import os
EXAMPLE_IMPEDANCE_VALUES_TO_TEST = [(1, '12VIN', 'J24', ),
                    (2, '5V', 'C211', ),
                    (3, '3.3V', 'C257', ),
                    (4, 'EMMC_3V3', 'R237', ),
                    (5, 'FE_28V', 'C464', ),]

def voltage_test(context, *args, **kwargs):
    base_message = "Please probe voltage of point #%d [%s at %s] and enter value in Volts in the box below. Expecting [%s]"
    generic_test(context, base_message, '_VOLTAGE_', *args, **kwargs)

def impedance_test(context, *args, **kwargs):
    base_message = "Please probe impedance of point #%d [%s at %s] and enter value in kOhms in the box below. Expecting [%s]"
    generic_test(context, base_message, '_IMPEDANCE_', *args, **kwargs)

def generic_test(context, base_message, criterion_middle_string, values_to_test, criteria_prefix, base_path=""):
    for values in values_to_test:
        num, name, component, support_image = values
        support_image = os.path.join(base_path, support_image)
        criteria_name = '%s%s%s' % (criteria_prefix, criterion_middle_string, name)
        eval_value = context.criteria.get_eval_value(criteria_name)
        message = base_message % (num, name, component, eval_value)
        value = context.wait_tester_feedback(message, image=support_image, input_parse_fn=float)
        context.criteria.evaluate(criteria_name, value)
